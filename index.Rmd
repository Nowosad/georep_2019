---
title: "Reproduciable spatial data analysis:"
subtitle: "An example of transportation in Bristol"
author: "Jakub Nowosad <br>https://nowosad.github.io"
date: "Collegium Da Vinci, 2019-01-29, Poznań"
output:
  xaringan::moon_reader:
    css: [default, metropolis, metropolis-fonts, "style.css"]
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: 16:9
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.align = "center")
```


# Geocomputation

<!-- what the hell is that? -->

---
# Geocomputation

<!-- grass gis + arc + r -->
.pull-left[

```{r gdsl, echo=FALSE, message=FALSE, results='asis'}
d = readr::read_csv('"Attribute","Desktop GIS (GUI)","R"
"Home disciplines","Geography","Computing, Statistics"
"Software focus","Graphical User Interface","Command line"
"Reproducibility","Minimal","Maximal"')
knitr::kable(x = d, 
             booktabs = TRUE, 
             format = "html")
```

]

.pull-right[
```{r, echo=FALSE, out.width="90%"}
knitr::include_graphics(c("figs/qgis.png", "figs/r.png"))
```
]

---
# Geocomputation

<!-- how and why -->
<!-- packages and posibilities -->

.pull-left[
- Facilitates the automation of repetitive tasks
- Enables transparency and reproducibility, the backbone of good scientific practice and data science
- Encourages software development by providing tools to modify existing functions and implement new ones
- Helps develop future-proof programming skills which are in high demand in many disciplines and industries
- Is user-friendly and fast, allowing an efficient workflow
]

---
# Geocomputation with R

An important feature of R (and Python) is that it is an interpreted language. This is advantageous because it enables interactive programming in a Read–Eval–Print Loop (REPL): code entered into the console is immediately executed and the result is printed, rather than waiting for the intermediate stage of compilation. 

R packages:

- **sf**, **raster** - spatial classes
- **dplyr**, **rmapshaper** - processing of atttribute tables/geometries 
- **rnaturalearth**, **osmdata**, **getlandsat** - spatial data download
- **rgrass7**, **RQGIS**, **RSAGA**, **link2GI** - connecting with GIS software
- **gstat**, **mlr**, **CAST** - spatial data modeling
- **rasterVis**, **tmap**, **ggplot** - static visualizations
- **leaflet**, **mapview**, **mapdeck** - interactive visualizations
- many more...

Learn more at https://cran.r-project.org/web/views/Spatial.html.

---
class: inverse, center, middle
# Basics

---
# R

```{r, echo=FALSE, out.width="90%"}
knitr::include_graphics("figs/geocompr.gif")
```

---
# Vector data


```{r, echo=FALSE}
library(spData)
```

.pull-left[
```{r, echo=FALSE, out.height=550}
knitr::include_graphics("figs/sf-classes.png", dpi = NA)
```
]


.pull-right[
Examples:
- 1
- 2
- 3
- 4
]

---
# Vector data

.pull-left[
```{r,echo=FALSE, message=FALSE}
library(sf)
library(tmap)
tm_shape(seine) + 
  tm_lines("name", palette = "Set2", lwd = 3)
```

]

.pull-right[

```{r}
library(sf)
head(seine)
```
<!-- - Model wektorowy danych oparty jest na punktach położonych wewnątrz danego układu współrzędnych -->

- The **sf** package provides a class system for spatial vector data 
- Additionally, this package uses the PROJ, GDAL oraz GEOS libraries, which allows for transformation between different coordinate reference systems, reading and writing many spatial data file formats, and executing geometric operations
]

---
# Raster data

```{r, echo=FALSE, out.height=400}
knitr::include_graphics("figs/raster-intro-plot2-1.png", dpi = NA)
```

- Raster maps usually represent continuous phenomena such as elevation, temperature, population density or spectral data
- Of course, we can represent discrete features such as soil or land-cover classes also with the help of a raster data model

---
# Raster data

.lc[
- The **raster** package provides a class system for spatial raster data, which constits of simple `RasterLayer`, and multilayer `RasterStack` and `RasterBrick`
- Operations on small raster are executed in RAM, and there is also a possibility of processing of large rasters by dividing them into smaller chunks
]

.rc[
```{r, echo=FALSE, out.height=200}
knitr::include_graphics("figs/raster-intro-plot-1.png", dpi = NA)
```

```{r, message=FALSE}
library(raster)
elev
```
]

---
class: inverse, center, middle
# Transportation analysis

---
# Introduction

<!-- about transportation -->

---
# Introduction

<!-- different geographic levels -->

---
# Bristol

---
# Aims

<!-- explain our aim -->

---
# Transportation zones

---
# Desire lines

---
# Routes

---
# Nodes

---
# Route networks

---
# Prioritizing new infrastructure

---
# Future directions of travel

---

<!-- .pull-left[ -->
<!-- ```{r, echo=FALSE, out.height=550} -->
<!-- knitr::include_graphics("figs/desire-1.png", dpi = NA) -->
<!-- ``` -->
<!-- ] -->

<!-- .pull-right[ -->
<!-- - Umiejętności tworzenia analiz przestrzennych mogą (powinny?) służyć rozwiązywaniom prawdziwych problemów. -->
<!-- - Książka zawiera trzy praktyczne przykłady - analizę transportu, geomarketingową oraz ekologiczną. -->
<!-- - Analiza transportu: w jaki sposób zwiększyć udział ruchu rowerowego w mieście Bristol? -->
<!-- - Taka analiza obejmuje: -->

<!--     - Jednostki powierzchniowe -->
<!--     - Linie celu -->
<!--     - Trasy -->
<!--     - Węzły -->
<!--     - Sieci transportowe -->

<!-- -    Areal units: transport patterns can be understood with reference to zonal aggregates such as the main mode of travel (by car, bike or foot, for example) and average distance of trips made by people living in a particular zone, covered in section 12.3. -->
<!-- -    Desire lines: straight lines that represent ‘origin-destination’ data that records how many people travel (or could travel) between places (points or zones) in geographic space, the topic of section 12.4. -->
<!-- -    Routes: these are lines representing a path along the route network along the desire lines defined in the previous bullet point. We will see how to create them in section 12.5. -->
<!-- -    Nodes: these are points in the transport system that can represent common origins and destinations and public transport stations such as bus stops and rail stations, the topic of section 12.6. -->
<!-- -    Route networks: these represent the system of roads, paths and other linear features in an area and are covered in section 12.7. They can be represented as geographic features (representing route segments) or structured as an interconnected graph, with the level of traffic on different segments referred to as ‘flow’ by transport modelers (Hollander 2016). -->
]


---
class: inverse, center, middle
# Geomarketing

---
# Geomarketing

- Typical example is where to locate a new shop. The aim here is to attract most visitors and, ultimately, make most profit
- There are also many non-commercial applications that can use the technique for public benefit, for example where to locate new health services
- Typical research questions include what are the target groups, where do target groups live and which areas do they frequent, where are competing stores or services located?

```{r, echo=FALSE, out.height=400}
knitr::include_graphics("figs/08_census_stack.png", dpi = NA)
```

---
# Geomarketing

.pull-left[
- To answer such questions you can:
    - Tidy the input data from a census
    - Convert the tabulated census data into raster objects
    - Identify metropolitan areas with high population densities
    - Download detailed geographic data (from OpenStreetMap, with `osmdata`) for these areas
    - Create rasters for scoring the relative desirability of different locations using map algebra
]

.pull-right[

```{r, echo=FALSE, out.height=550}
knitr::include_graphics("figs/08_metro_areas.png", dpi = NA)
```
]

---
# Geomarketing

<center>Suitable areas in accordance with our hypothetical survey for bike stores in Berlin</center>

```{r, echo=FALSE, out.height=500}
knitr::include_graphics("figs/08_result.png", dpi = NA)
```

---
class: inverse, center, middle
# Geocomputation with R 

---
# The Geocomputation with R book

.lc[
```{r, out.width=350, echo=FALSE}
knitr::include_graphics("figs/bc.png")
```
]

.rc[

**Fifteen chapters** starting from an introduction to spatial objects in R, going through basic spatial operations, visualizations, bridges with GIS software, spatial machine learning, creating spatial functions, and ending with case studies
<br>

> Lovelace R., Nowosad J., Muenchow J. 2019, **Geocomputation with R**. CRC Press

- The online version of this book is free to read at https://geocompr.robinlovelace.net/
- This book has been also published by CRC Press (http://bit.ly/geocomp_with_r)
<br>
]

---
class: inverse, center, middle
# Summary

---
# Summary

<!-- .pull-right[ -->
<!-- **Aktywne przeczytanie tej książki zachęca do:** -->

<!-- - Kreatywnego wykorzystania danych przestrzennych -->
<!-- - Zastosowania umiejętności do prawdziwych problemów -->
<!-- - Tworzenia nowych narzędzi -->
<!-- - Dbania o odtwarzalność wyników -->

<!-- **Co dalej?** -->

<!-- - Rozwijanie wiedzy na temat R -->
<!-- - Odkrywanie przetwarzania danych przestrzennych w innych językach programowania -->
<!-- - Eksplorowanie i uczenie się nowych technik i metod -->
<!-- ] -->

.pull-right[
This brings us to the ‘open source approach’, which has three main components:

- A command-line interface (CLI), encouraging scripts recording geographic work to be shared and reproduced
- Open source software, which can be inspected and potentially improved by anyone in the world
- An active developer community, which collaborates and self-organizes to build complimentary and modular tools
]


---
class: center, middle
<!-- # Dziękuję -->

.pull-left[
## About me:

Twitter: `r icon::ii_social_twitter()` jakub_nowosad

Email: nowosad.jakub@gmail.com
]

.pull-right[
## More info:

https://nowosad.github.io

https://geocompr.github.io/

]

